<link rel="import" href="../bower_components/polymer/polymer-element.html">
<link rel="import" href="shared-styles.html">
<link rel="import" href="../bower_components/iron-flex-layout/iron-flex-layout-classes.html">
<link rel="import" href="../bower_components/iron-ajax/iron-ajax.html">

<dom-module id="my-voltage">
  <template is="auto-binding">
  <style include="shared-styles iron-flex iron-flex-alignment">
  .circle {
    display: inline-block;
    text-align:center;
    color: black;
    border-radius: 70%;
    background: #ddd;
    font-size: 30px;
    width: 110px;
    height: 110px;
    margin: 15px;
  }
  .red {
    display: inline-block;
    text-align:center;
    color: red;
    border-radius: 70%;
    background: #ddd;
    font-size: 30px;
    width: 110px;
    height: 110px;
    margin: 15px;
  }
  .green {
    display: inline-block;
    text-align:center;
    color: green;
    border-radius: 70%;
    background: #ddd;
    font-size: 30px;
    width: 110px;
    height: 110px;
    margin: 15px;
  }
  p {
      font-size: 0.8em;
  }
  </style>
  <iron-ajax id="ajax"
           auto
           url="https://turbine-farm.run.aws-usw02-pr.ice.predix.io/api/turbines/1/sensors/voltage"
           last-response="{{volts}}"
           on-response="_onResponse"
           handle-as="json"
           on-error="_handleErrorResponse">
</iron-ajax>
<iron-ajax id="ajax1"
         auto
         url="https://turbine-farm.run.aws-usw02-pr.ice.predix.io/api/turbines/1/sensors/temperature"
         last-response="{{temp}}"
         on-response="_onResponse1"
         handle-as="json"
         on-error="_handleErrorResponse1">
</iron-ajax>
<iron-ajax id="ajax2"
         auto
         url="https://turbine-farm.run.aws-usw02-pr.ice.predix.io/api/turbines/1/heartbeat"
         last-response="{{hb}}"
         on-response="_onResponse2"
         handle-as="json"
         on-error="_handleErrorResponse2">
</iron-ajax>
<iron-ajax id="ajax3"
         auto
         url="https://turbine-farm.run.aws-usw02-pr.ice.predix.io/api/turbines/2/sensors/voltage"
         last-response="{{volts1}}"
         on-response="_onResponse3"
         handle-as="json"
         on-error="_handleErrorResponse3">
</iron-ajax>
<iron-ajax id="ajax4"
       auto
       url="https://turbine-farm.run.aws-usw02-pr.ice.predix.io/api/turbines/2/sensors/temperature"
       last-response="{{temp1}}"
       on-response="_onResponse4"
       handle-as="json"
       on-error="_handleErrorResponse4">
</iron-ajax>
<iron-ajax id="ajax5"
       auto
       url="https://turbine-farm.run.aws-usw02-pr.ice.predix.io/api/turbines/2/heartbeat"
       last-response="{{hb1}}"
       on-response="_onResponse5"
       handle-as="json"
       on-error="_handleErrorResponse5">
</iron-ajax>
<iron-ajax id="ajax6"
         auto
         url="https://turbine-farm.run.aws-usw02-pr.ice.predix.io/api/turbines/3/sensors/voltage"
         last-response="{{volts2}}"
         on-response="_onResponse6"
         handle-as="json"
         on-error="_handleErrorResponse6">
</iron-ajax>
<iron-ajax id="ajax7"
       auto
       url="https://turbine-farm.run.aws-usw02-pr.ice.predix.io/api/turbines/3/sensors/temperature"
       last-response="{{temp2}}"
       on-response="_onResponse7"
       handle-as="json"
       on-error="_handleErrorResponse7">
</iron-ajax>
<iron-ajax id="ajax8"
       auto
       url="https://turbine-farm.run.aws-usw02-pr.ice.predix.io/api/turbines/3/heartbeat"
       last-response="{{hb2}}"
       on-response="_onResponse8"
       handle-as="json"
       on-error="_handleErrorResponse8">
</iron-ajax>
<paper-tabs selected="0" scrollable>
<paper-tab>
  <div class="card">
  <div class="layout horizontal">
    <div class="circle"><p>{{volts.value}}V</p></div>
    <div class="circle"><p>{{temp.value}}F</p></div>
    <div class$="[[class]]"><p>{{hb.status}}</p></div>
  </div>
</div>
</paper-tab>
<paper-tab>  <div class="card">
  <div class="layout horizontal">
    <div class="circle"><p>{{volts1.value}}V</p></div>
    <div class="circle"><p>{{temp1.value}}F</p></div>
    <div class$="[[class1]]"><p>{{hb1.status}}</p></div>
  </div>
</div>
</paper-tab>
<paper-tab>
  <div class="card">
  <div class="layout horizontal">
    <div class="circle"><p>{{volts2.value}}V</p></div>
    <div class="circle"><p>{{temp2.value}}F</p></div>
    <div class$="[[class2]]"><p>{{hb2.status}}</p></div>
  </div>
</div>
</paper-tab>
</paper-tabs>
  </template>
  <script>

    class MyVoltage extends Polymer.Element {
      static get is() {
        return "my-voltage";
      }
      _onResponse() {
        setTimeout(() => this.$.ajax.generateRequest(), 2000);
      }
      _onResponse1() {
      setTimeout(() => this.$.ajax1.generateRequest(), 2000);
      }
      _onResponse2() {
        if(this.hb.status == "ONLINE") {
          this.class = "green";
        } else {
          this.class = "red";
        }
        setTimeout(() => this.$.ajax2.generateRequest(), 2000);
      }
      _onResponse3() {
        setTimeout(() => this.$.ajax3.generateRequest(), 2000);
      }
      _onResponse4() {
        setTimeout(() => this.$.ajax4.generateRequest(), 2000);
      }
      _onResponse5() {
        if(this.hb1.status == "ONLINE") {
          this.class1 = "green";
        } else {
          this.class1 = "red";
        }
        setTimeout(() => this.$.ajax5.generateRequest(), 2000);
      }
      _onResponse6() {
        setTimeout(() => this.$.ajax6.generateRequest(), 2000);
      }
      _onResponse7() {
        setTimeout(() => this.$.ajax7.generateRequest(), 2000);
      }
      _onResponse8() {
        if(this.hb2.status == "ONLINE") {
          this.class2 = "green";
        } else {
          this.class2 = "red";
        }
        setTimeout(() => this.$.ajax8.generateRequest(), 2000);
      }
      _handleErrorResponse(){
        this.volts.value = "--";
        setTimeout(() => this.$.ajax.generateRequest(), 2000);
      }
      _handleErrorResponse1(){
        this.temp.value = "--";
        setTimeout(() => this.$.ajax1.generateRequest(), 2000);
      }
      _handleErrorResponse2(){
        this.hb.status = "N/A";
        this.class = "red";
        setTimeout(() => this.$.ajax2.generateRequest(), 2000);
      }
      _handleErrorResponse3(){
        this.volts.value = "--";
        setTimeout(() => this.$.ajax3.generateRequest(), 2000);
      }
      _handleErrorResponse4(){
        this.temp.value = "--";
        setTimeout(() => this.$.ajax4.generateRequest(), 2000);
      }
      _handleErrorResponse5(){
        this.hb1.status = "N/A";
        this.class = "red";
        setTimeout(() => this.$.ajax5.generateRequest(), 2000);
      }
      _handleErrorResponse6(){
        this.volts.value = "--";
        setTimeout(() => this.$.ajax6.generateRequest(), 2000);
      }
      _handleErrorResponse7(){
        this.temp.value = "--";
        setTimeout(() => this.$.ajax7.generateRequest(), 2000);
      }
      _handleErrorResponse8(){
        this.hb2.status = "N/A";
        this.class = "red";
        setTimeout(() => this.$.ajax8.generateRequest(), 2000);
      }

      static get properties() {
        return {
          volts: {
            type: String,
            notify: true,
            reflectToAttribute: true
          },
        }
      }

      constructor() {
        super();
      }
    }
    customElements.define(MyVoltage.is, MyVoltage);



  </script>
</dom-module>
